Here you find the code used to perform all the analyses in the paper "Frequency-specific theta states in the hippocampus modulate population activity with respect to behavioural context", 
by Laura Masaracchia, Felipe Fredes and Diego Vidaurre. doi:doi: https://doi.org/10.1101/2024.12.11.627908. 

This work focuses on the relationship between brain states and neural information processing, using multi-scale electrophysiological data (i.e., LFP and spikes). 

We develop *state-conditioned decoding*, a method combining a data-driven approach and standard decoding. 
We detect network states from the meso-scale (LFP) data with the hidden Markov models, and use these states to drive the decoding of trial information from the micro-scale (spikes) data. 
Our work shows how network states modulate the representation of information across the whole population of neurons: *ensemble pattern modulation*.

The figure summarizes our hypothesis and results
<img width="667" alt="image" src="https://github.com/user-attachments/assets/ccc07b1c-2dde-44e4-b715-1f0afb3b17cd" />

The paper uses pre-recorded data (see Shahbaba et al., 2022, DOI: https://doi.org/10.1038/s41467-022-28057-6), that are not included in this repository. 

The files in this repository reproduce all analyses and figures (main and supplemental) of our paper.
